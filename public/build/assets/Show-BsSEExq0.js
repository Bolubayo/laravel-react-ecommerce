import{r as l,j as e,m as E,K as q,S as O,L as S,$ as y}from"./app-B8WagT0Y.js";import{a as _,A as C,C as A}from"./AuthenticatedLayout-DYFTrcju.js";function k({images:i}){const[t,c]=l.useState(i[0]||null);return l.useEffect(()=>{i.length>0&&c(i[0])},[i]),l.useEffect(()=>{const a=m=>{if(m.key==="ArrowRight"){const d=(i.findIndex(x=>x.id===(t==null?void 0:t.id))+1)%i.length;c(i[d])}else if(m.key==="ArrowLeft"){const d=(i.findIndex(x=>x.id===(t==null?void 0:t.id))-1+i.length)%i.length;c(i[d])}};return window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}},[t,i]),l.useEffect(()=>{const a=setInterval(()=>{const o=(i.findIndex(d=>d.id===(t==null?void 0:t.id))+1)%i.length;c(i[o])},5e3);return()=>clearInterval(a)},[t,i]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-start gap-8",children:[e.jsx("div",{className:"flex flex-col items-center gap-2 py-2",children:i.map((a,m)=>e.jsx("button",{onClick:()=>c(a),className:`border-2 rounded ${(t==null?void 0:t.id)===a.id?"border-blue-500 shadow-lg":"border-transparent hover:border-blue-500"}`,children:e.jsx("img",{src:a.thumb,alt:`Thumbnail of ${a.id}`,className:"w-[50px]"})},a.id))}),e.jsx("div",{className:"carousel w-full",children:e.jsx("div",{className:"carousel-item w-full",children:t&&e.jsx("img",{src:t.large,alt:`Selected image ${t.id}`,className:"w-full"})})})]})})}function T({appName:i,product:t,variationOptions:c}){var j;const a=E({option_ids:{},quantity:1,price:null}),{url:m}=q(),[o,d]=l.useState([]),x=l.useMemo(()=>{for(let r in o){const n=o[r];if(n.images.length>0)return n.images}return t.images},[t,o]),p=l.useMemo(()=>{const r=Object.values(o).map(n=>n.id).sort();for(let n of t.variations){const s=n.variation_type_option_ids.sort();if(_(r,s))return{price:n.price,quantity:n.quantity===null?Number.MAX_VALUE:n.quantity}}return{price:t.price,quantity:t.quantity}},[t,o]);l.useEffect(()=>{for(let r of t.variationTypes){const n=c[r.id];console.log(n,r.options),f(r.id,r.options.find(s=>s.id==n)||r.options[0],!1)}},[]);const v=r=>Object.fromEntries(Object.entries(r).map(([n,s])=>[n,s.id])),f=(r,n,s=!0)=>{d(u=>{const h={...u,[r]:n};return s&&O.get(m,{options:v(h)},{preserveScroll:!0,preserveState:!0}),h})},g=r=>{a.setData("quantity",parseInt(r.target.value))},N=()=>{a.post(route("cart.store",t.id),{preserveScroll:!0,preserveState:!0,onError:r=>{console.log(r)}})},w=()=>{var r;return(r=t.variationTypes)==null?void 0:r.map(n=>e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block font-semibold mb-2",children:n.name}),n.type==="Image"&&e.jsx("div",{className:"flex gap-3",children:n.options.map(s=>{var u,h,b;return e.jsx("div",{onClick:()=>f(n.id,s),className:`p-1 rounded cursor-pointer border ${((u=o[n.id])==null?void 0:u.id)===s.id?"outline outline-4 outline-primary":"outline outline-1 outline-gray-300"}`,children:e.jsx("img",{src:(b=(h=s.images)==null?void 0:h[0])==null?void 0:b.thumb,alt:s.name,className:"w-12 h-12 object-cover rounded"})},s.id)})}),n.type==="Radio"&&e.jsx("div",{className:"flex gap-2 mt-2 flex-wrap",children:n.options.map(s=>{var u;return e.jsx("button",{type:"button",onClick:()=>f(n.id,s),className:`px-4 py-1 rounded border text-sm ${((u=o[n.id])==null?void 0:u.id)===s.id?"bg-blue-700 text-white border-blue-600":"bg-white border-gray-300 hover:bg-gray-100"}`,children:s.name},s.id)})})]},n.id))},I=()=>e.jsxs("div",{className:"mb-8 flex gap-4",children:[e.jsx("select",{value:a.data.quantity,onChange:g,className:"select select-bordered w-full",children:Array.from({length:Math.min(10,p.quantity)}).map((r,n)=>e.jsxs("option",{value:n+1,children:["Quantity: ",n+1]},n+1))}),e.jsx("button",{onClick:N,className:"btn btn-primary",children:"Add to Cart"})]});return l.useEffect(()=>{const r=Object.fromEntries(Object.entries(o).map(([n,s])=>[n,s.id]));console.log(r),a.setData("option_ids",r)},[o]),e.jsxs(C,{children:[e.jsxs(S,{children:[e.jsx("title",{children:t.title}),e.jsx("meta",{name:"title",content:t.meta_title}),e.jsx("meta",{name:"description",content:t.meta_description}),e.jsx("link",{rel:"canonical",href:route("product.show",t.slug)}),e.jsx("meta",{property:"og:title",content:t.title}),e.jsx("meta",{property:"og:description",content:t.meta_description}),e.jsx("meta",{property:"og:image",content:(j=x[0])==null?void 0:j.small}),e.jsx("meta",{property:"og:url",content:route("product.show",t.slug)}),e.jsx("meta",{property:"og:type",content:"product"}),e.jsx("meta",{property:"og:site_name",content:i})]}),e.jsx("div",{className:"container mx-auto p-8",children:e.jsxs("div",{className:"grid gap-8 grid-cols-1 lg:grid-cols-12",children:[e.jsx("div",{className:"col-span-7",children:e.jsx(k,{images:x})}),e.jsxs("div",{className:"col-span-5",children:[e.jsx("h1",{className:"text-2xl",children:t.title}),e.jsxs("p",{className:"mb-8",children:["by ",e.jsx(y,{href:route("vendor.profile",t.user.store_name),className:"hover::underline",children:t.user.name}),"Â  in ",e.jsx(y,{href:route("product.byDepartment",t.department.slug),className:"hover::underline",children:t.department.name})]}),e.jsx("div",{children:e.jsx("div",{className:"text-3xl font-semibold",children:e.jsx(A,{amount:p.price})})}),w(),p.quantity!=null&&p.quantity<10&&e.jsx("div",{className:"text-error my-4",children:e.jsxs("span",{children:["Only ",p.quantity," left"]})}),I(),e.jsx("b",{className:"text-xl",children:"About the Item"}),e.jsx("div",{className:"wysiwyg-output",dangerouslySetInnerHTML:{__html:t.description}})]})]})})]})}export{T as default};
